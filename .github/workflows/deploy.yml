name: Push-to-EC2
on:
  push:
    branches:
      - main
jobs:
  deploy:
    name: Deploy to Windows Server
    runs-on: self-hosted
    steps:
    
    - name: Checkout the files
      uses: actions/checkout@v3

    - name: List Published Files
      run: |
        $publishedFiles = Get-ChildItem -Recurse ./Drts.Lives.API/API/bin/Release/net8.0/publish/
        Write-Host "Published Files:"
        $publishedFiles | ForEach-Object { Write-Host $_.FullName }

    - name: Copy files with PowerShell
      run: |
        Copy-Item -Path ./Drts.Lives.API/API/bin/Release/net8.0/publish/* -Destination C:\inetpub\wwwroot\Drts.Live.API\Teste
